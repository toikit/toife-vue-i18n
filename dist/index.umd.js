(function(i,u){typeof exports=="object"&&typeof module<"u"?u(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],u):(i=typeof globalThis<"u"?globalThis:i||self,u(i.ToifeVueI18n={},i.Vue))})(this,function(i,u){"use strict";let f=u.ref([]),s="";const l=u.ref({}),a=u.ref([]),c=u.ref("");function h(e){Array.isArray(e)?e.forEach(t=>{f.value.push(t)}):f.value.push(e),v(c.value)}function d(e={},t={}){for(const r of Object.keys(t)){const n=t[r],o=e[r];n&&typeof n=="object"&&!Array.isArray(n)&&!(n instanceof Function)?e[r]=d(o&&typeof o=="object"?o:{},n):e[r]=n}return e}function y(e,t){if(!e)return;const r=t.split(".");let n=e;for(const o of r){if(n==null)return;n=n[o]}return n}function g(e,t={}){return String(e).replace(/\{(\w+)\}/g,(r,n)=>t[n]===void 0?`{${n}}`:String(t[n]))}async function _(e,t,r){try{if(a.value.includes(t))return;const n=await import(r+"?t="+new Date().getTime()),o=n.default??n;if(typeof o!="object"||o===null)throw new Error(`Locale module ${e} did not export an object`);l.value[e]=l.value[e]||{},l.value[e][t]=d(l.value[e]?.[t]||{},o),a.value.push(t),localStorage.setItem("__data_locale_"+t,JSON.stringify(o))}catch{let o=localStorage.getItem("__data_locale_"+t);o&&(l.value[e][t]=d(l.value[e]?.[t]||{},JSON.parse(o)),a.value.push(t))}}async function v(e){for(let t of f.value){const r=t.template.replace("{locale}",encodeURIComponent(e));_(e,t.name,r)}}async function b(e){c.value=e,await v(e)}function w(e){s=e}function L(){return c.value}function S(e){return function(t,r={}){const n=l.value[c.value]?.[e]||{};let o=y(n,t);if(o===void 0&&c.value!==s){const p=l.value[s]?.[e]||{};o=y(p,t)}if(o===void 0)return g(t,r);if(typeof o=="function")try{return o(r)}catch(p){return console.warn("i18n function error for key",t,p),""}return g(o,r)}}function T(){return{locale:u.computed(()=>c.value),isLocaleLoaded:e=>a.value.includes(e),setFallbackLocale:w,setLocale:b,addLocaleModule:h,getLocale:L}}u.watch(c,async(e,t)=>{t!==void 0&&await v(e)},{immediate:!0}),i.useI18n=T,i.useTranslator=S,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
