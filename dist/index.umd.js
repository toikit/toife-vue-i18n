(function(u,i){typeof exports=="object"&&typeof module<"u"?i(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],i):(u=typeof globalThis<"u"?globalThis:u||self,i(u.ToifeVueI18n={},u.Vue))})(this,function(u,i){"use strict";let d=i.ref([]);const a={},f=i.ref([]),c=i.ref("en");function L(e){d.value.push(e),l(c.value)}function p(e={},n={}){for(const r of Object.keys(n)){const t=n[r],o=e[r];t&&typeof t=="object"&&!Array.isArray(t)&&!(t instanceof Function)?e[r]=p(o&&typeof o=="object"?o:{},t):e[r]=t}return e}function A(e,n){if(!e)return;const r=n.split(".");let t=e;for(const o of r){if(t==null)return;t=t[o]}return t}function m(e,n={}){return String(e).replace(/\{(\w+)\}/g,(r,t)=>n[t]===void 0?`{${t}}`:String(n[t]))}async function l(e){try{for(let n of d.value){const r=n.template.replace("{locale}",encodeURIComponent(e));if(f.value.includes(n.name))continue;const t=await import(r+"?t="+new Date().getTime()),o=t.default??t;if(typeof o!="object"||o===null)throw new Error(`Locale module ${e} did not export an object`);a[e]=a[e]||{},a[e][n.name]=p(a[e]?.[n.name]||{},o),f.value.push(n.name)}return a[e]}catch{return e!=="en"?l("en"):{}}}async function v(e){c.value=e,await l(e)}function C(){return c.value}function y(e){return function(n,r={}){const t=a[c.value]?.[e]||{};let o=A(t,n);if(o===void 0&&c.value!=="en"){const s=a.en?.[e]||{};o=A(s,n)}if(o===void 0)return m(n,r);if(typeof o=="function")try{return o(r)}catch(s){return console.warn("i18n function error for key",n,s),""}return m(o,r)}}function E(){return{locale:i.computed(()=>c.value),isLocaleLoaded:e=>{const n=e.replace("{locale}",encodeURIComponent(c.value));return f.value.includes(n)},setLocale:v,addLocaleModule:L,useTranslator:y,loadLocale:l,getLocale:C}}i.watch(c,async(e,n)=>{n!==void 0&&await l(e)},{immediate:!0}),u.addLocaleModule=L,u.getLocale=C,u.loadLocale=l,u.setLocale=v,u.useI18n=E,u.useTranslator=y,Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})});
