(function(u,i){typeof exports=="object"&&typeof module<"u"?i(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],i):(u=typeof globalThis<"u"?globalThis:u||self,i(u.ToifeVueI18n={},u.Vue))})(this,function(u,i){"use strict";let f=i.ref([]),a="";const l={},p=i.ref([]),v=i.ref([]),c=i.ref("");function b(e){Array.isArray(e)?e.forEach(n=>{f.value.push(n)}):f.value.push(e),s(c.value)}function y(e={},n={}){for(const o of Object.keys(n)){const t=n[o],r=e[o];t&&typeof t=="object"&&!Array.isArray(t)&&!(t instanceof Function)?e[o]=y(r&&typeof r=="object"?r:{},t):e[o]=t}return e}function h(e,n){if(!e)return;const o=n.split(".");let t=e;for(const r of o){if(t==null)return;t=t[r]}return t}function m(e,n={}){return String(e).replace(/\{(\w+)\}/g,(o,t)=>n[t]===void 0?`{${t}}`:String(n[t]))}async function L(e,n,o){try{const t=await import(n+"?t="+new Date().getTime()),r=t.default??t;if(typeof r!="object"||r===null)throw new Error(`Locale module ${o} did not export an object`);l[o]=l[o]||{},l[o][e]=y(l[o]?.[e]||{},r)}catch(t){console.log(t)}finally{p.value.push(e)}}async function s(e){for(let n of f.value){const o=n.template.replace("{locale}",encodeURIComponent(e));v.value.includes(o)||(v.value.push(o),L(n.name,o,e))}}async function g(e){c.value=e,await s(e)}function w(e){a=e}function T(){return c.value}function j(e){return function(n,o={}){const t=l[c.value]?.[e]||{};let r=h(t,n);if(r===void 0&&c.value!==a){const d=l[a]?.[e]||{};r=h(d,n)}if(r===void 0)return m(n,o);if(typeof r=="function")try{return r(o)}catch(d){return console.warn("i18n function error for key",n,d),""}return m(r,o)}}function A(){return{locale:i.computed(()=>c.value),isLocaleLoaded:e=>p.value.includes(e),setFallbackLocale:w,setLocale:g,addLocaleModule:b,getLocale:T}}i.watch(c,async(e,n)=>{n!==void 0&&await s(e)},{immediate:!0}),u.useI18n=A,u.useTranslator=j,Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})});
