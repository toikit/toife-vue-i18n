(function(i,c){typeof exports=="object"&&typeof module<"u"?c(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],c):(i=typeof globalThis<"u"?globalThis:i||self,c(i.ToifeVueI18n={},i.Vue))})(this,function(i,c){"use strict";let d=c.ref([]);const f={},a=new Set,u=c.ref("en");function s(e){d.value.push(e),l(u.value)}function L(e={},n={}){for(const o of Object.keys(n)){const t=n[o],r=e[o];t&&typeof t=="object"&&!Array.isArray(t)&&!(t instanceof Function)?e[o]=L(r&&typeof r=="object"?r:{},t):e[o]=t}return e}function p(e,n){if(!e)return;const o=n.split(".");let t=e;for(const r of o){if(t==null)return;t=t[r]}return t}function A(e,n={}){return String(e).replace(/\{(\w+)\}/g,(o,t)=>n[t]===void 0?`{${t}}`:String(n[t]))}async function l(e){try{for(let n of d.value){const o=n.replace("{locale}",encodeURIComponent(e));if(a.has(o))continue;a.add(o);const t=await import(o+"?t="+new Date().getTime()),r=t.default??t;if(typeof r!="object"||r===null)throw new Error(`Locale module ${e} did not export an object`);f[e]=L(f[e]||{},r)}return f[e]}catch{return e!=="en"?l("en"):{}}}async function m(e){u.value=e,await l(e)}function v(){return u.value}function C(e,n={}){const o=f[u.value]||{};let t=p(o,e);if(t===void 0&&u.value!=="en"){const r=f.en||{};t=p(r,e)}if(t===void 0)return A(e,n);if(typeof t=="function")try{return t(n)}catch(r){return console.warn("i18n function error for key",e,r),""}return A(t,n)}function y(){return{locale:c.computed(()=>u.value),isLocaleLoaded:e=>{const n=e.replace("{locale}",encodeURIComponent(u.value));return a.has(n)},setLocale:m,addLocaleModuleUrlTemplate:s,t:C,loadLocale:l,getLocale:v}}c.watch(u,async(e,n)=>{n!==void 0&&await l(e)},{immediate:!0}),i.addLocaleModuleUrlTemplate=s,i.getLocale=v,i.loadLocale=l,i.setLocale=m,i.t=C,i.useI18n=y,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
