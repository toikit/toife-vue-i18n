(function(i,u){typeof exports=="object"&&typeof module<"u"?u(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],u):(i=typeof globalThis<"u"?globalThis:i||self,u(i.ToifeVueI18n={},i.Vue))})(this,function(i,u){"use strict";let s=u.ref([]),a="";const c={},p=u.ref([]),v=u.ref([]),f=u.ref("");function b(e){Array.isArray(e)?e.forEach(t=>{s.value.push(t)}):s.value.push(e),l(f.value)}function m(e={},t={}){for(const r of Object.keys(t)){const n=t[r],o=e[r];n&&typeof n=="object"&&!Array.isArray(n)&&!(n instanceof Function)?e[r]=m(o&&typeof o=="object"?o:{},n):e[r]=n}return e}function h(e,t){if(!e)return;const r=t.split(".");let n=e;for(const o of r){if(n==null)return;n=n[o]}return n}function y(e,t={}){return String(e).replace(/\{(\w+)\}/g,(r,n)=>t[n]===void 0?`{${n}}`:String(t[n]))}async function l(e){try{for(let t of s.value){const r=t.template.replace("{locale}",encodeURIComponent(e));if(v.value.includes(r))continue;v.value.push(r);const n=await import(r+"?t="+new Date().getTime()),o=n.default??n;if(typeof o!="object"||o===null)throw new Error(`Locale module ${e} did not export an object`);c[e]=c[e]||{},c[e][t.name]=m(c[e]?.[t.name]||{},o),p.value.push(t.name)}return c[e]}catch{return e!==a?l(a):{}}}async function L(e){f.value=e,await l(e)}function w(e){a=e}function T(){return f.value}function g(e){return function(t,r={}){const n=c[f.value]?.[e]||{};let o=h(n,t);if(o===void 0&&f.value!==a){const d=c[a]?.[e]||{};o=h(d,t)}if(o===void 0)return y(t,r);if(typeof o=="function")try{return o(r)}catch(d){return console.warn("i18n function error for key",t,d),""}return y(o,r)}}function j(){return{locale:u.computed(()=>f.value),isLocaleLoaded:e=>p.value.includes(e),setFallbackLocale:w,setLocale:L,addLocaleModule:b,getLocale:T}}u.watch(f,async(e,t)=>{t!==void 0&&await l(e)},{immediate:!0}),i.useI18n=j,i.useTranslator=g,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
