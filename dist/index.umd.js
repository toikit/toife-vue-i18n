(function(i,r){typeof exports=="object"&&typeof module<"u"?r(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],r):(i=typeof globalThis<"u"?globalThis:i||self,r(i.ToifeVueI18n={},i.Vue))})(this,function(i,r){"use strict";let a=r.ref([]),f="";const l=r.ref({}),p=r.ref([]),v=r.ref([]),c=r.ref("");function b(e){Array.isArray(e)?e.forEach(n=>{a.value.push(n)}):a.value.push(e),s(c.value)}function y(e={},n={}){for(const o of Object.keys(n)){const t=n[o],u=e[o];t&&typeof t=="object"&&!Array.isArray(t)&&!(t instanceof Function)?e[o]=y(u&&typeof u=="object"?u:{},t):e[o]=t}return e}function h(e,n){if(!e)return;const o=n.split(".");let t=e;for(const u of o){if(t==null)return;t=t[u]}return t}function m(e,n={}){return String(e).replace(/\{(\w+)\}/g,(o,t)=>n[t]===void 0?`{${t}}`:String(n[t]))}async function L(e,n,o){try{const t=await import(n+"?t="+new Date().getTime()),u=t.default??t;if(typeof u!="object"||u===null)throw new Error(`Locale module ${o} did not export an object`);l.value[o]=l.value[o]||{},l.value[o][e]=y(l.value[o]?.[e]||{},u)}catch(t){console.log(t)}finally{p.value.push(e)}}async function s(e){for(let n of a.value){const o=n.template.replace("{locale}",encodeURIComponent(e));v.value.includes(o)||(v.value.push(o),L(n.name,o,e))}}async function g(e){c.value=e,await s(e)}function w(e){f=e}function T(){return c.value}function j(e){return function(n,o={}){const t=l.value[c.value]?.[e]||{};let u=h(t,n);if(u===void 0&&c.value!==f){const d=l.value[f]?.[e]||{};u=h(d,n)}if(u===void 0)return m(n,o);if(typeof u=="function")try{return u(o)}catch(d){return console.warn("i18n function error for key",n,d),""}return m(u,o)}}function A(){return{locale:r.computed(()=>c.value),isLocaleLoaded:e=>p.value.includes(e),setFallbackLocale:w,setLocale:g,addLocaleModule:b,getLocale:T}}r.watch(c,async(e,n)=>{n!==void 0&&await s(e)},{immediate:!0}),i.useI18n=A,i.useTranslator=j,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
