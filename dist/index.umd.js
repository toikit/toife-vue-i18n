(function(i,u){typeof exports=="object"&&typeof module<"u"?u(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],u):(i=typeof globalThis<"u"?globalThis:i||self,u(i.ToifeVueI18n={},i.Vue))})(this,function(i,u){"use strict";let a=u.ref([]),f="";const l=u.ref({}),s=u.ref([]),c=u.ref("");function h(e){Array.isArray(e)?e.forEach(t=>{a.value.push(t)}):a.value.push(e),p(c.value)}function d(e={},t={}){for(const r of Object.keys(t)){const n=t[r],o=e[r];n&&typeof n=="object"&&!Array.isArray(n)&&!(n instanceof Function)?e[r]=d(o&&typeof o=="object"?o:{},n):e[r]=n}return e}function y(e,t){if(!e)return;const r=t.split(".");let n=e;for(const o of r){if(n==null)return;n=n[o]}return n}function g(e,t={}){return String(e).replace(/\{(\w+)\}/g,(r,n)=>t[n]===void 0?`{${n}}`:String(t[n]))}async function _(e,t,r){try{const n=await import(r+"?t="+new Date().getTime()),o=n.default??n;if(typeof o!="object"||o===null)throw new Error(`Locale module ${e} did not export an object`);l.value[e]=l.value[e]||{},l.value[e][t]=d(l.value[e]?.[t]||{},o),s.value.push(t),localStorage.setItem("__data_locale_"+t,JSON.stringify(o))}catch{let o=localStorage.getItem("__data_locale_"+t);o&&(l.value[e][t]=d(l.value[e]?.[t]||{},JSON.parse(o)),s.value.push(t))}}async function p(e){for(let t of a.value){const r=t.template.replace("{locale}",encodeURIComponent(e));_(e,t.name,r)}}async function b(e){c.value=e,await p(e)}function m(e){f=e}function w(){return c.value}function L(e){return function(t,r={}){const n=l.value[c.value]?.[e]||{};let o=y(n,t);if(o===void 0&&c.value!==f){const v=l.value[f]?.[e]||{};o=y(v,t)}if(o===void 0)return g(t,r);if(typeof o=="function")try{return o(r)}catch(v){return console.warn("i18n function error for key",t,v),""}return g(o,r)}}function S(){return{locale:u.computed(()=>c.value),isLocaleLoaded:e=>s.value.includes(e),setFallbackLocale:m,setLocale:b,addLocaleModule:h,getLocale:w}}u.watch(c,async(e,t)=>{t!==void 0&&await p(e)},{immediate:!0}),i.useI18n=S,i.useTranslator=L,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
