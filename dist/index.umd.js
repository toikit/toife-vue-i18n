(function(i,r){typeof exports=="object"&&typeof module<"u"?r(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],r):(i=typeof globalThis<"u"?globalThis:i||self,r(i.ToifeVueI18n={},i.Vue))})(this,function(i,r){"use strict";let f=r.ref([]),s="";const a=r.ref({}),d=r.ref([]),v=r.ref([]),c=r.ref("");function b(e){Array.isArray(e)?e.forEach(t=>{f.value.push(t)}):f.value.push(e),p(c.value)}function y(e={},t={}){for(const o of Object.keys(t)){const n=t[o],u=e[o];n&&typeof n=="object"&&!Array.isArray(n)&&!(n instanceof Function)?e[o]=y(u&&typeof u=="object"?u:{},n):e[o]=n}return e}function h(e,t){if(!e)return;const o=t.split(".");let n=e;for(const u of o){if(n==null)return;n=n[u]}return n}function m(e,t={}){return String(e).replace(/\{(\w+)\}/g,(o,n)=>t[n]===void 0?`{${n}}`:String(t[n]))}async function L(e,t,o,n=!1){try{const u=await import(o+"?t="+new Date().getTime()),l=u.default??u;if(typeof l!="object"||l===null)throw new Error(`Locale module ${e} did not export an object`);a.value[e]=a.value[e]||{},a.value[e][t]=y(a.value[e]?.[t]||{},l),d.value.push(t)}catch{n||d.value.push(t)}}async function p(e){for(let t of f.value){const o=t.template.replace("{locale}",encodeURIComponent(e));v.value.includes(o)||(v.value.push(o),L(e,t.name,o,t.required))}}async function w(e){c.value=e,await p(e)}function T(e){s=e}function g(){return c.value}function j(e){return function(t,o={}){const n=a.value[c.value]?.[e]||{};let u=h(n,t);if(u===void 0&&c.value!==s){const l=a.value[s]?.[e]||{};u=h(l,t)}if(u===void 0)return m(t,o);if(typeof u=="function")try{return u(o)}catch(l){return console.warn("i18n function error for key",t,l),""}return m(u,o)}}function A(){return{locale:r.computed(()=>c.value),isLocaleLoaded:e=>d.value.includes(e),setFallbackLocale:T,setLocale:w,addLocaleModule:b,getLocale:g}}r.watch(c,async(e,t)=>{t!==void 0&&await p(e)},{immediate:!0}),i.useI18n=A,i.useTranslator=j,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
