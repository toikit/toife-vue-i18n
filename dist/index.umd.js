(function(i,u){typeof exports=="object"&&typeof module<"u"?u(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],u):(i=typeof globalThis<"u"?globalThis:i||self,u(i.ToifeVueI18n={},i.Vue))})(this,function(i,u){"use strict";let d=u.ref([]);const f={},l=u.ref([]),c=u.ref("en");function m(e){d.value.push(e),a(c.value)}function L(e={},n={}){for(const r of Object.keys(n)){const t=n[r],o=e[r];t&&typeof t=="object"&&!Array.isArray(t)&&!(t instanceof Function)?e[r]=L(o&&typeof o=="object"?o:{},t):e[r]=t}return e}function p(e,n){if(!e)return;const r=n.split(".");let t=e;for(const o of r){if(t==null)return;t=t[o]}return t}function A(e,n={}){return String(e).replace(/\{(\w+)\}/g,(r,t)=>n[t]===void 0?`{${t}}`:String(n[t]))}async function a(e){try{for(let n of d.value){const r=n.template.replace("{locale}",encodeURIComponent(e));if(l.value.includes(n.name))continue;const t=await import(r+"?t="+new Date().getTime()),o=t.default??t;if(typeof o!="object"||o===null)throw new Error(`Locale module ${e} did not export an object`);f[e]=f[e]||{},f[e][n.name]=L(f[e]?.[n.name]||{},o),l.value.push(n.name)}return f[e]}catch{return e!=="en"?a("en"):{}}}async function v(e){c.value=e,await a(e)}function C(){return c.value}function y(e){return function(n,r={}){const t=f[c.value]?.[e]||{};let o=p(t,n);if(o===void 0&&c.value!=="en"){const s=f.en?.[e]||{};o=p(s,n)}if(o===void 0)return A(n,r);if(typeof o=="function")try{return o(r)}catch(s){return console.warn("i18n function error for key",n,s),""}return A(o,r)}}function E(){return{locale:u.computed(()=>c.value),isLocaleLoaded:e=>{const n=e.replace("{locale}",encodeURIComponent(c.value));return l.value.includes(n)},setLocale:v,addLocaleModule:m,loadLocale:a,getLocale:C}}u.watch(c,async(e,n)=>{n!==void 0&&await a(e)},{immediate:!0}),i.useI18n=E,i.useTranslator=y,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
